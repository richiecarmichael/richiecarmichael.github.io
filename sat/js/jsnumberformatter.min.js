function NaNError(n){this.name="NaNError";this.message="NaN "||n}var JsNumberFormatter={consts:{regexStrNonNumeric:"[^0-9\\.]",negativeParanRegex:"^\\(([^\\)]+)\\)$",numberRegex:new RegExp("^([0-9]*)\\.([0-9]*)$"),maskCharsStr:"[0#]",maskCharsRegex:new RegExp("[0#]","g")},parseNumberSimple:function(n,t,i,r){var e;if(i=typeof i!="undefined"?i:!1,i&&console.log("["+n+"] Checking params..."),typeof n!="string")throw new TypeError("Expecting a string as numberString param");t=typeof t!="undefined"?t:new this.parseNumberSimpleOptions;i&&(console.log("["+n+"] Options="+t.print()),console.log("["+n+"] Params OK"));for(var f=n,s=new this.parseContext(i,t,this),o=t.compileOperators(this,!1),u=0;u<o.operators.length;u++)f=o.operators[u].parse(n,f,s);if(typeof r!="undefined")for(u=0;u<r.length;u++)f=o.operators[u].parse(n,f,s);for(s.isPost=!0,u=0;u<o.operators.length;u++)f=o.operators[u].postParse(n,f,s);if(typeof r!="undefined")for(u=0;u<r.length;u++)f=o.operators[u].postParse(n,f,s);if(e=typeof f=="Number"?f:new Number(f),isNaN(e))throw new NaNError;return t.roundingDecimalPlaces>=0&&(e=JsNumberFormatter.util.round(e,t.roundingDecimalPlaces,i,e<0,t.roundingMode)),i&&console.log("Output: "+e),e},parseOperators:function(){this.operators=[];this.add=function(n){this.operators[this.operators.length]=n}},parseContext:function(n,t,i){this.log=n;this.options=t;this.nf=i;this.isNegative=!1;this.isPerc=!1;this.isPost=!1},parseNumberSimpleOptions:function(){this.decimalStr=".";this.groupStr=",";this.strict=!1;this.trim=!0;this.removeBadCh=!1;this.negativeMatch=new RegExp("^-(.+)");this.percEnabled=!1;this.percMatch=new RegExp("^(.+)%");this.operatorsCached=null;this.roundingDecimalPlaces=-1;this.roundingMode=JsNumberFormatter.util.RoundHalfUp;this.specifyAll=function(n,t,i,r,u,f){if(typeof n!="undefined"){if(typeof n!="string")throw new TypeError("Expecting a string as decimalStr param");this.decimalStr=n}if(typeof t!="undefined"){if(typeof t!="string")throw new TypeError("Expecting a string as groupStr param");this.groupStr=t}return this.specifyStrict(i),this.specifyTrim(r),this.specifyRemoveBadCh(u),this.specifyNegativeMatch(f),this};this.specifyStrict=function(n){if(typeof n!="undefined"){if(typeof n!="boolean")throw new TypeError("Expecting a boolean as strict param");this.strict=n}return this};this.specifyTrim=function(n){if(typeof n!="undefined"){if(typeof n!="boolean")throw new TypeError("Expecting a boolean as trim param");this.trim=n}return this};this.specifyRemoveBadCh=function(n){if(typeof n!="undefined"){if(typeof n!="boolean")throw new TypeError("Expecting a boolean as removeBadCh param");this.removeBadCh=n}return this};this.specifyNegativeMatch=function(n){if(typeof n!="undefined"){if(typeof n!="string")throw new TypeError("Expecting a string as negativeMatch param");this.negativeMatch=new RegExp(n)}return this};this.specifyPerc=function(n,t){if(this.percEnabled=n,typeof t!="undefined"){if(typeof t!="string")throw new TypeError("Expecting a string as match param");this.percMatch=new RegExp(t)}return this};this.specifyRounding=function(n,t){if(typeof n=="undefined")throw new TypeError("Expecting a number for roundingMode param");if(typeof n!="number")throw new TypeError("Expecting a number for roundingMode param");if(typeof t!="undefined"){if(typeof t!="number")throw new TypeError("Expecting a number for decimalPlaces param");this.roundingDecimalPlaces=t}return this.roundingMode=n,this};this.print=function(){return'parseNumberSimpleOptions{decimalStr:"'+this.decimalStr+'",groupStr:"'+this.groupStr+'",strict:"'+this.strict+'",trim:"'+this.trim+'",removeBadCh:"'+this.removeBadCh+'",negativeMatch:"'+this.negativeMatch+'"}'};this.compileOperators=function(n,t){return(this.operatorsCached===null||t)&&(this.operatorsCached=new n.parseOperators,this.trim&&this.operatorsCached.add(new JsNumberFormatter.modules.Trim),this.negativeMatch&&this.operatorsCached.add(new JsNumberFormatter.modules.NegativeNumber),this.operatorsCached.add(new JsNumberFormatter.modules.FormattedNumber),this.percEnabled&&this.operatorsCached.add(new JsNumberFormatter.modules.Percentage),this.removeBadCh&&this.operatorsCached.add(new JsNumberFormatter.modules.BadChars)),this.operatorsCached}},formatNumber:function(n,t,i){var e,r,o,f,s,h,u;if(i=typeof i!="undefined"?i:!1,i&&console.log("["+n+"] Checking params..."),typeof n!="number")throw new TypeError("Expecting a number as number param");return t=typeof t!="undefined"?t:new this.formatNumberOptions,i&&(console.log("["+n+"] Options="+t.print()),console.log("["+n+"] Params OK")),t.compiled||(i&&console.log("Compiling options..."),t.compile(new this.formatMaskCompiled(t.groupMaskStr),new this.formatMaskCompiled(t.decimalMaskStr),i)),e=0,r=this.consts.numberRegex.exec(n),r&&(e=r[2].length),t.decimalMaskStr.length<e&&(n=JsNumberFormatter.util.round(n,t.decimalMaskStr.length,i,n<0,t.roundingMode)),i&&console.log("Splitting number to parts..."),r=this.consts.numberRegex.exec(n),r?(o=r[1],f=r[2]):(o=n,f=""),e=f.length,i&&console.log("Parts=integer:"+o+",decimal:"+f),i&&console.log("Applying group mask..."),s=t.groupMask.apply(o),i&&console.log("Applying decimal mask..."),h=t.decimalMask.apply(f),u=h.length>0?s+t.decimalSeperatorStr+h:s,t.prefix!==null&&(u=t.prefix+u),t.postfix!==null&&(u=u+t.postfix),i&&console.log("Result="+u),u},formatNumberOptions:function(){this.groupMaskStr=",###";this.decimalSeperatorStr=".";this.decimalMaskStr="##";this.negativeMaskStr="-(.+)";this.prefix=null;this.postfix=null;this.groupMask=null;this.decimalMask=null;this.compiled=!1;this.numberMaskValidRegex=new RegExp("[#0]","g");this.roundingMode=JsNumberFormatter.util.RoundHalfUp;this.specifyAll=function(n,t,i,r){if(typeof n!="undefined"){if(typeof n!="string")throw new TypeError("Expecting a string as groupMaskStr param");this.groupMaskStr=n}if(typeof t!="undefined"){if(typeof t!="string")throw new TypeError("Expecting a string as decimalMaskStr param");this.decimalMaskStr=t}if(typeof i!="undefined"){if(typeof i!="string")throw new TypeError("Expecting a string as decimalSeperatorStr param");this.decimalSeperatorStr=i}if(typeof r!="undefined"){if(typeof r!="string")throw new TypeError("Expecting a string as negativeMaskStr param");this.negativeMaskStr=r}var u=n.match(this.numberMaskValidRegex);if(!u||u.length===0)throw new Error('groupMaskStr must have at least 1 "0" or "#" char');if(u=t.match(this.numberMaskValidRegex),!u||u.length===0)throw new Error('decimalMaskStr must have at least 1 "0" or "#" char');return this};this.specifyDecimalMask=function(n){var t=n.match(this.numberMaskValidRegex);if(!t||t.length===0)throw new Error('decimalMaskStr must have at least 1 "0" or "#" char');return this.decimalMaskStr=n,this};this.specifyFixes=function(n,t){if(this.prefix=n,typeof t!="undefined"){if(typeof t!="string")throw new TypeError("Expecting a string for postfix param");this.postfix=t}return this};this.specifyRounding=function(n){if(typeof n=="undefined")throw new TypeError("Expecting a number for roundingMode param");if(typeof n!="number")throw new TypeError("Expecting a number for roundingMode param");return this.roundingMode=n,this};this.print=function(){return'parseNumberSimpleOptions{groupMaskStr:"'+this.groupMaskStr+'",decimalMaskStr:"'+this.decimalMaskStr+'",decimalSeperatorStr:"'+this.decimalSeperatorStr+'",negativeMaskStr:"'+this.negativeMaskStr+'"}'};this.compile=function(n,t,i){this.compiled||(this.groupMask=n,this.groupMask.reversed=!0,this.groupMask.repeating=!0,this.groupMask.compile(i),this.decimalMask=t,this.decimalMask.reversed=!1,this.decimalMask.repeating=!1,this.decimalMask.compile(i))}},formatMaskCompiled:function(n){this.maskStr=n;this.repeating=!1;this.reversed=!1;this.compiled=!1;this.maskDigitSize=-1;this.roundingMode=JsNumberFormatter.util.RoundHalfUp;this.apply=function(t,i){var u,f,r;if(!this.compiled)throw new Error("Mask not compiled");if(t=""+t,i&&console.log('Applying mask:"'+this.maskStr+'",reversed='+this.reversed+',input="'+t+'"'),u="",this.repeating){if(this.reversed)for(f=t.length,i&&console.log("length="+f),r=f;r>=0;r-=this.maskDigitSize){i&&console.log("Pos:"+r);var e=r-this.maskDigitSize<0?0:r-this.maskDigitSize,s=f===1?(""+t).substring(e,r):t.substring(e,r),o=this._applyReverseMask(n,s,e>0,i);if(o==="")break;u=o+u}return u}return this.reversed?this._applyReverseMask(n,t,!1,i):this._applyMask(n,t,i)};this.compile=function(n){var t=this.maskStr.match(new RegExp("[0#]","g"));this.maskDigitSize=t.length;n&&console.log("Compiled at length:"+this.maskDigitSize);this.compiled=!0};this._applyMask=function(n,t,i){var u="",e,f,r,o;if(n.length<t.length)throw new Error('Mask is not long enough, mask:"'+n+'",number="'+t+'"');for(e=typeof t.length=="undefined"?1:t.length,f=0;f<n.length;f++)if(r=n.charAt(f),f<e)o=t.charAt(f),u+=r==="0"||r=="#"?o:r;else if(i&&console.log("Mask ch:"+r),r==="0")i&&console.log("Zero pad"),u+="0";else if(r=="#")break;else{u+=r;break}return u=="0"&&n.charAt(n.length-1)=="#"&&(u=""),i&&console.log("Mask result="+u),u};this._applyReverseMask=function(n,t,i,r){var f,o,u,s,e,h;if(r&&console.log('Applying reverse mask:"'+n+'"areMore:'+i+',str:"'+t+'"'),f="",n.length<t.length)throw new Error('Mask is not long enough, mask:"'+n+'",number="'+t+'"');for(o=t.length-1,u=null,s=n.length-1;s>=0;s--)if(e=n.charAt(s),r&&console.log("Mask ch:"+e),o>=0)r&&console.log("Digit Pos:"+o),e==="0"||e=="#"?(h=t.charAt(o),r&&console.log("Digit:"+h),o--,u!==null&&(r&&console.log("Writing hold chars:"+u),f=u+f,u=null),f=h+f):(u=u!==null?e+u:e,r&&console.log("Held char:"+e));else if(e==="0")null!==u&&(r&&console.log("Writing hold chars:"+u),f=u+f,u=null),f="0"+f;else if(e=="#")break;else u=u!==null?e+u:e,r&&console.log("Held char:"+e);return i&&u!==null&&(f=u+f),f=="0"&&n.charAt(n.length-1)=="#"&&(f=""),r&&console.log("Mask result="+f),f}},util:{RoundHalfUp:0,RoundHalfDown:1,RoundAwayFromZero:2,RoundTowardsZero:3,round:function(n,t,i,r,u){var f,e;if(typeof u=="undefined"&&(u=JsNumberFormatter.util.RoundHalfUp),i&&console.log("Rounding "+n+" using mode="+u),u===JsNumberFormatter.util.RoundHalfUp)f=Number(Math.round(n+"e"+t)+"e-"+t);else if(u===JsNumberFormatter.util.RoundHalfDown)e=5/Math.pow(10,t+1),n=n-e,f=Number(Math.ceil(n+"e"+t)+"e-"+t);else if(u===JsNumberFormatter.util.RoundAwayFromZero)f=r?Number(Math.floor(n+"e"+t)+"e-"+t):Number(Math.ceil(n+"e"+t)+"e-"+t);else if(u===JsNumberFormatter.util.RoundTowardsZero)f=r?Number(Math.ceil(n+"e"+t)+"e-"+t):Number(Math.floor(n+"e"+t)+"e-"+t);else throw new Error('Unknown rounding mode:"'+u);return i&&console.log("["+n+"] Rounded to "+f),f},HashMap:function(){this._dict={};this._shared={id:1};this._size=0;this.put=function(n,t){return typeof n=="object"&&(n.hasOwnProperty._id||(n.hasOwnProperty=function(n){return Object.prototype.hasOwnProperty.call(this,n)},n.hasOwnProperty._id=this._shared.id++),n=n.hasOwnProperty._id),typeof this._dict[n]=="undefined"&&this._size++,this._dict[n]=t,this};this.get=function(n){return typeof n=="object"?this._dict[n.hasOwnProperty._id]:this._dict[n]};this.size=function(){return this._size}}},modules:{FormattedNumber:function(){this.parse=function(n,t,i){var u=i.options.groupStr,r;if(i.log&&console.log(u),u=u.replace(new RegExp("\\.","g"),"\\."),i.log&&console.log(u),t=t.replace(new RegExp(u,"g"),""),i.log&&console.log("["+t+"] Removed groups..."),i.options.decimalStr!="."&&(t=t.replace(new RegExp(i.options.decimalStr,"g"),"."),i.log&&console.log("["+t+"] Replaced decimal point(s)...")),i.options.strict){if(i.log&&console.log("["+t+"] Counting decimal points..."),r=t.match(new RegExp("\\.","g")).length,r>1)throw new Error("Input has more than 1 decimal point: "+r);if(!i.options.removeBadCh&&(i.log&&console.log("["+t+"] Counting disallowed chars..."),r=t.match(new RegExp(i.nf.consts.regexStrNonNumeric,"g")).length,r>0))throw new Error("Input has "+r+" disallowed chars: "+t);}return t};this.postParse=function(n,t){return t}},BadChars:function(){this.parse=function(n,t,i){return i.options.removeBadCh&&(i.log&&console.log("["+t+"] Removing bad chars..."),t=t.replace(new RegExp(i.nf.consts.regexStrNonNumeric,"g"),""),i.log&&console.log("["+t+"] Removed bad chars...")),t};this.postParse=function(n,t){return t}},Trim:function(){this.parse=function(n,t,i){return i.options.trim&&(t=t.replace(new RegExp("^\\s+|\\s+$","g"),""),i.log&&console.log("["+t+"] Trimmed")),t};this.postParse=function(n,t){return t}},NegativeNumber:function(){this.parse=function(n,t,i){if(i.options.negativeMatch){i.log&&console.log("["+t+"] Removing any negative signs...");var r=i.options.negativeMatch.exec(t);r&&(t=r[1],i.isNegative=!0,i.log&&console.log("["+t+"] Removed negative sign and any fixes"))}return t};this.postParse=function(n,t,i){return i.isNegative&&(t="-"+t),t}},Percentage:function(){this.parse=function(n,t,i){if(i.options.percEnabled){var r=i.options.percMatch.exec(t);r&&(t=r[1],i.isPerc=!0,i.log&&console.log("["+t+"] is percentage"))}return t};this.postParse=function(n,t,i){var r,u;return i.isPerc&&(r=t.indexOf(i.options.decimalStr),r=r>=0?t.length-(r+1)+2:2,u=new Number(t),t=u/=100,t=JsNumberFormatter.util.round(t,r,i.log,i.isNegative),i.log&&console.log("["+t+"] Converted to percentage...")),t}}}};NaNError.prototype=Error.prototype;
//# sourceMappingURL=jsnumberformatter.min.js.map
